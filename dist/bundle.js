/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./node_modules/sql.js-httpvfs/dist/index.js":
/*!***************************************************!*\
  !*** ./node_modules/sql.js-httpvfs/dist/index.js ***!
  \***************************************************/
/***/ (function(module) {

eval("!function(e,t){if(true)module.exports=t();else { var r, n; }}(this,(function(){return(()=>{\"use strict\";var e={870:(e,t,n)=>{n.r(t),n.d(t,{createEndpoint:()=>o,expose:()=>l,proxy:()=>v,proxyMarker:()=>r,releaseProxy:()=>a,transfer:()=>y,transferHandlers:()=>c,windowEndpoint:()=>g,wrap:()=>f});const r=Symbol(\"Comlink.proxy\"),o=Symbol(\"Comlink.endpoint\"),a=Symbol(\"Comlink.releaseProxy\"),i=Symbol(\"Comlink.thrown\"),s=e=>\"object\"==typeof e&&null!==e||\"function\"==typeof e,c=new Map([[\"proxy\",{canHandle:e=>s(e)&&e[r],serialize(e){const{port1:t,port2:n}=new MessageChannel;return l(e,t),[n,[n]]},deserialize:e=>(e.start(),f(e))}],[\"throw\",{canHandle:e=>s(e)&&i in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function l(e,t=self){t.addEventListener(\"message\",(function n(r){if(!r||!r.data)return;const{id:o,type:a,path:s}=Object.assign({path:[]},r.data),c=(r.data.argumentList||[]).map(w);let f;try{const t=s.slice(0,-1).reduce(((e,t)=>e[t]),e),n=s.reduce(((e,t)=>e[t]),e);switch(a){case 0:f=n;break;case 1:t[s.slice(-1)[0]]=w(r.data.value),f=!0;break;case 2:f=n.apply(t,c);break;case 3:f=v(new n(...c));break;case 4:{const{port1:t,port2:n}=new MessageChannel;l(e,n),f=y(t,[t])}break;case 5:f=void 0}}catch(e){f={value:e,[i]:0}}Promise.resolve(f).catch((e=>({value:e,[i]:0}))).then((e=>{const[r,i]=b(e);t.postMessage(Object.assign(Object.assign({},r),{id:o}),i),5===a&&(t.removeEventListener(\"message\",n),u(t))}))})),t.start&&t.start()}function u(e){(function(e){return\"MessagePort\"===e.constructor.name})(e)&&e.close()}function f(e,t){return d(e,[],t)}function p(e){if(e)throw new Error(\"Proxy has been released and is not useable\")}function d(e,t=[],n=function(){}){let r=!1;const i=new Proxy(n,{get(n,o){if(p(r),o===a)return()=>E(e,{type:5,path:t.map((e=>e.toString()))}).then((()=>{u(e),r=!0}));if(\"then\"===o){if(0===t.length)return{then:()=>i};const n=E(e,{type:0,path:t.map((e=>e.toString()))}).then(w);return n.then.bind(n)}return d(e,[...t,o])},set(n,o,a){p(r);const[i,s]=b(a);return E(e,{type:1,path:[...t,o].map((e=>e.toString())),value:i},s).then(w)},apply(n,a,i){p(r);const s=t[t.length-1];if(s===o)return E(e,{type:4}).then(w);if(\"bind\"===s)return d(e,t.slice(0,-1));const[c,l]=m(i);return E(e,{type:2,path:t.map((e=>e.toString())),argumentList:c},l).then(w)},construct(n,o){p(r);const[a,i]=m(o);return E(e,{type:3,path:t.map((e=>e.toString())),argumentList:a},i).then(w)}});return i}function m(e){const t=e.map(b);return[t.map((e=>e[0])),(n=t.map((e=>e[1])),Array.prototype.concat.apply([],n))];var n}const h=new WeakMap;function y(e,t){return h.set(e,t),e}function v(e){return Object.assign(e,{[r]:!0})}function g(e,t=self,n=\"*\"){return{postMessage:(t,r)=>e.postMessage(t,n,r),addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}function b(e){for(const[t,n]of c)if(n.canHandle(e)){const[r,o]=n.serialize(e);return[{type:3,name:t,value:r},o]}return[{type:0,value:e},h.get(e)||[]]}function w(e){switch(e.type){case 3:return c.get(e.name).deserialize(e.value);case 0:return e.value}}function E(e,t,n){return new Promise((r=>{const o=new Array(4).fill(0).map((()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16))).join(\"-\");e.addEventListener(\"message\",(function t(n){n.data&&n.data.id&&n.data.id===o&&(e.removeEventListener(\"message\",t),r(n.data))})),e.start&&e.start(),e.postMessage(Object.assign({id:o},t),n)}))}},162:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,\"default\",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)\"default\"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};Object.defineProperty(t,\"__esModule\",{value:!0}),t.createDbWorker=void 0;const i=a(n(870));async function s(e){if(e.data&&\"eval\"===e.data.action){const t=new Int32Array(e.data.notify,0,2),n=new Uint8Array(e.data.notify,8);let r;try{r={ok:await u(e.data.request)}}catch(t){console.error(\"worker request error\",e.data.request,t),r={err:String(t)}}const o=(new TextEncoder).encode(JSON.stringify(r));n.set(o,0),t[1]=o.length,Atomics.notify(t,0)}}function c(e){if(\"BODY\"===e.tagName)return\"body\";const t=[];for(;e.parentElement&&\"BODY\"!==e.tagName;){if(e.id){t.unshift(\"#\"+e.id);break}{let n=1,r=e;for(;r.previousElementSibling;)r=r.previousElementSibling,n++;t.unshift(e.tagName.toLowerCase()+\":nth-child(\"+n+\")\")}e=e.parentElement}return t.join(\" > \")}function l(e){return Object.keys(e)}async function u(e){if(console.log(\"dom vtable request\",e),\"select\"===e.type)return[...document.querySelectorAll(e.selector)].map((t=>{const n={};for(const r of e.columns)\"selector\"===r?n.selector=c(t):\"parent\"===r?t.parentElement&&(n.parent=t.parentElement?c(t.parentElement):null):\"idx\"===r||(n[r]=t[r]);return n}));if(\"insert\"===e.type){if(!e.value.parent)throw Error('\"parent\" column must be set when inserting');const t=document.querySelectorAll(e.value.parent);if(0===t.length)throw Error(`Parent element ${e.value.parent} could not be found`);if(t.length>1)throw Error(`Parent element ${e.value.parent} ambiguous (${t.length} results)`);const n=t[0];if(!e.value.tagName)throw Error(\"tagName must be set for inserting\");const r=document.createElement(e.value.tagName);for(const t of l(e.value))if(null!==e.value[t]){if(\"tagName\"===t||\"parent\"===t)continue;if(\"idx\"===t||\"selector\"===t)throw Error(`${t} can't be set`);r[t]=e.value[t]}return n.appendChild(r),null}if(\"update\"===e.type){const t=document.querySelector(e.value.selector);if(!t)throw Error(`Element ${e.value.selector} not found!`);const n=[];for(const r of l(e.value)){const o=e.value[r];if(\"parent\"!==r){if(\"idx\"!==r&&\"selector\"!==r&&o!==t[r]){if(console.log(\"SETTING \",r,t[r],\"->\",o),\"tagName\"===r)throw Error(\"can't change tagName\");n.push(r)}}else if(o!==c(t.parentElement)){const e=document.querySelectorAll(o);if(1!==e.length)throw Error(`Invalid target parent: found ${e.length} matches`);e[0].appendChild(t)}}for(const r of n)t[r]=e.value[r];return null}throw Error(`unknown request ${e.type}`)}i.transferHandlers.set(\"WORKERSQLPROXIES\",{canHandle:e=>!1,serialize(e){throw Error(\"no\")},deserialize:e=>(e.start(),i.wrap(e))}),t.createDbWorker=async function(e,t,n,r=1/0){const o=new Worker(t),a=i.wrap(o),c=await a.SplitFileHttpDatabase(n,e,void 0,r);return o.addEventListener(\"message\",s),{db:c,worker:a,configs:e}}},432:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)\"default\"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,\"__esModule\",{value:!0}),o(n(162),t)}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}return n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n(432)})()}));\n//# sourceMappingURL=index.js.map\n\n//# sourceURL=webpack:///./node_modules/sql.js-httpvfs/dist/index.js?");

/***/ }),

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var sql_js_httpvfs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sql.js-httpvfs */ \"./node_modules/sql.js-httpvfs/dist/index.js\");\n/* harmony import */ var sql_js_httpvfs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sql_js_httpvfs__WEBPACK_IMPORTED_MODULE_0__);\n// MCU Random 2023\n// ------------------------------------------------------------\n\nconst workerUrl = new URL(/* asset import */ __webpack_require__(/*! sql.js-httpvfs/dist/sqlite.worker.js */ \"./node_modules/sql.js-httpvfs/dist/sqlite.worker.js\"), __webpack_require__.b);\nconst wasmUrl = new URL(/* asset import */ __webpack_require__(/*! sql.js-httpvfs/dist/sql-wasm.wasm */ \"./node_modules/sql.js-httpvfs/dist/sql-wasm.wasm\"), __webpack_require__.b);\nlet worker;\n// ------------------------------------------------------------\nasync function load() {\n    worker = await (0,sql_js_httpvfs__WEBPACK_IMPORTED_MODULE_0__.createDbWorker)([{\n            from: \"inline\",\n            config: {\n                serverMode: \"full\",\n                url: \"./universe.db\",\n                requestChunkSize: 4096,\n            },\n        },], workerUrl.toString(), wasmUrl.toString());\n    // Categories section\n    const query_movies = await worker.db.query(`SELECT * FROM titles_movies`);\n    const query_tv_shows = await worker.db.query(`SELECT * FROM titles_tv`);\n    const query_animation = await worker.db.query(`SELECT * FROM titles_animation`);\n    const query_specials = await worker.db.query(`SELECT * FROM titles_specials`);\n    const query_oneshots = await worker.db.query(`SELECT * FROM titles_oneshots`);\n    const query_webseries = await worker.db.query(`SELECT * FROM titles_webseries`);\n    const query_comics = await worker.db.query(`SELECT * FROM titles_comics`);\n    const query_games = await worker.db.query(`SELECT * FROM titles_games`);\n    const query_musicals = await worker.db.query(`SELECT * FROM titles_musicals`);\n    const query_books = await worker.db.query(`SELECT * FROM titles_books`);\n    const query_documentary = await worker.db.query(`SELECT * FROM titles_documentary`);\n    // Sagas section\n    const query_the_infinity_saga = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE saga=\"The Infinity Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE saga=\"The Infinity Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE saga=\"The Infinity Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE saga=\"The Infinity Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE saga=\"The Infinity Saga\" ORDER BY release_date ASC`);\n    const query_the_multiverse_saga = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE saga=\"The Multiverse Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE saga=\"The Multiverse Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE saga=\"The Multiverse Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE saga=\"The Multiverse Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE saga=\"The Multiverse Saga\" ORDER BY release_date ASC`);\n    // Series section\n    const query_spiderverse = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE series LIKE \"%Spider-Verse%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies_legacy WHERE series LIKE \"%Spider-Verse%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE series LIKE \"%Spider-Verse%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE series LIKE \"%Spider-Verse%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE series LIKE \"%Spider-Verse%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE series LIKE \"%Spider-Verse%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_webseries WHERE series LIKE \"%Spider-Verse%\" ORDER BY release_date ASC`);\n    const query_the_defenders_saga = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE series=\"The Defenders Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE series=\"The Defenders Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE series=\"The Defenders Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE series=\"The Defenders Saga\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE series=\"The Defenders Saga\" ORDER BY release_date ASC`);\n    const query_marvel_heroes = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE series=\"Marvel Heroes\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE series=\"Marvel Heroes\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE series=\"Marvel Heroes\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE series=\"Marvel Heroes\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE series=\"Marvel Heroes\" ORDER BY release_date ASC`);\n    const query_young_adult = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE series=\"Young Adult\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE series=\"Young Adult\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE series=\"Young Adult\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE series=\"Young Adult\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE series=\"Young Adult\" ORDER BY release_date ASC`);\n    const query_marvel_legacy_movies = await worker.db.query(`SELECT * FROM titles_movies_legacy`);\n    const query_adventure_into_fear = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE series LIKE \"%Adventure into Fear%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies_legacy WHERE series LIKE \"%Adventure into Fear%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE series LIKE \"%Adventure into Fear%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE series LIKE \"%Adventure into Fear%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE series LIKE \"%Adventure into Fear%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE series LIKE \"%Adventure into Fear%\" ORDER BY release_date ASC`);\n    // Current section\n    const query_upcoming = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description, imdb FROM titles_movies WHERE release_date > DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description, imdb FROM titles_tv WHERE release_date > DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description, imdb FROM titles_animation WHERE release_date > DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description, imdb FROM titles_oneshots WHERE release_date > DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description, imdb FROM titles_specials WHERE release_date > DATE('now') ORDER BY release_date ASC`);\n    const query_running_now = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM ( SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE release_date <= DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE release_date <= DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE release_date <= DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE release_date <= DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE release_date <= DATE('now')) ORDER BY release_date DESC LIMIT 1`);\n    // const query_running_now = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description, description FROM ( SELECT title, poster, saga, phase, release_date, type, description, description FROM titles_movies WHERE studio = \"Marvel Studios\" AND release_date <= DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description, description FROM titles_tv WHERE studio = \"Marvel Studios\" AND release_date <= DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE studio = \"Marvel Studios\" AND release_date <= DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description, description FROM titles_oneshots WHERE studio = \"Marvel Studios\" AND release_date <= DATE('now') UNION SELECT title, poster, saga, phase, release_date, type, description, description FROM titles_specials WHERE studio = \"Marvel Studios\" AND release_date <= DATE('now')) ORDER BY release_date DESC LIMIT 1`);\n    // Phases section\n    const query_phase_one = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE phase=\"Phase One\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE phase=\"Phase One\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE phase=\"Phase One\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE phase=\"Phase One\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE phase=\"Phase One\" ORDER BY release_date ASC`);\n    const query_phase_two = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE phase=\"Phase Two\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE phase=\"Phase Two\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE phase=\"Phase Two\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE phase=\"Phase Two\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE phase=\"Phase Two\" ORDER BY release_date ASC`);\n    const query_phase_three = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE phase=\"Phase Three\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE phase=\"Phase Three\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE phase=\"Phase Three\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE phase=\"Phase Three\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE phase=\"Phase Three\" ORDER BY release_date ASC`);\n    const query_phase_four = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE phase=\"Phase Four\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE phase=\"Phase Four\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE phase=\"Phase Four\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE phase=\"Phase Four\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE phase=\"Phase Four\" ORDER BY release_date ASC`);\n    const query_phase_five = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE phase=\"Phase Five\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE phase=\"Phase Five\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE phase=\"Phase Five\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE phase=\"Phase Five\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE phase=\"Phase Five\" ORDER BY release_date ASC`);\n    const query_phase_six = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE phase=\"Phase Six\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE phase=\"Phase Six\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE phase=\"Phase Six\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE phase=\"Phase Six\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE phase=\"Phase Six\" ORDER BY release_date ASC`);\n    // Universe section\n    const query_marvel_cinematic_universe = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies  WHERE studio = \"Marvel Studios\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv  WHERE studio = \"Marvel Studios\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation  WHERE studio = \"Marvel Studios\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots  WHERE studio = \"Marvel Studios\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials  WHERE studio = \"Marvel Studios\" ORDER BY release_date ASC`);\n    const query_fox_xmen_universe = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE series LIKE \"%Fox's X-Men Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies_legacy WHERE series LIKE \"%Fox's X-Men Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE series LIKE \"%Fox's X-Men Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE series LIKE \"%Fox's X-Men Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE series LIKE \"%Fox's X-Men Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE series LIKE \"%Fox's X-Men Universe%\" ORDER BY release_date ASC`);\n    const query_sony_spiderman_universe = await worker.db.query(`SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies WHERE series LIKE \"%Sony's Spider-Man Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_movies_legacy WHERE series LIKE \"%Sony's Spider-Man Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_tv WHERE series LIKE \"%Sony's Spider-Man Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_animation WHERE series LIKE \"%Sony's Spider-Man Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_oneshots WHERE series LIKE \"%Sony's Spider-Man Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_specials WHERE series LIKE \"%Sony's Spider-Man Universe%\" UNION SELECT title, poster, saga, phase, release_date, type, description FROM titles_webseries WHERE series LIKE \"%Sony's Spider-Man Universe%\" ORDER BY release_date ASC`);\n    const query_characters = await worker.db.query(`SELECT * FROM universe_characters`);\n    // Episodes\n    const query_tv_episodes = await worker.db.query(`SELECT * FROM episodes_tv`);\n    const query_animation_episodes = await worker.db.query(`SELECT * FROM episodes_animation`);\n    const query_webseries_episodes = await worker.db.query(`SELECT * FROM episodes_webseries`);\n    const query_runtime = await worker.db.query(`SELECT runtime, type FROM ( SELECT runtime, type FROM titles_movies UNION SELECT runtime, type FROM titles_tv UNION SELECT runtime, type FROM titles_animation UNION SELECT runtime, type FROM titles_oneshots UNION SELECT runtime, type FROM titles_specials UNION SELECT runtime, type FROM titles_webseries UNION SELECT runtime, type FROM titles_movies_legacy) ORDER BY type`);\n    // Sections\n    async function fetchSections() {\n        const querySections = await worker.db.query(`SELECT name FROM web_sections ORDER BY sorting ASC`);\n        const sectionsContainer = document.getElementById(\"sectionsContainer\");\n        if (sectionsContainer) {\n            querySections.forEach((section) => {\n                const sectionElement = document.createElement(\"div\");\n                sectionElement.classList.add(\"section\");\n                sectionElement.setAttribute(\"name\", section.name);\n                if (section.name !== \"Current\") {\n                    const sectionNameElement = document.createElement(\"div\");\n                    sectionNameElement.classList.add(\"separator\");\n                    sectionNameElement.textContent = section.name;\n                    sectionElement.appendChild(sectionNameElement);\n                }\n                sectionsContainer.appendChild(sectionElement);\n            });\n        }\n    }\n    // Categories\n    async function fetchCategories() {\n        const queryCategories = await worker.db.query(`SELECT name, section, description FROM web_categories`);\n        const sectionContainers = document.getElementsByClassName(\"section\");\n        queryCategories.forEach(async (category) => {\n            const sectionContainer = Array.from(sectionContainers).find((container) => {\n                const sectionName = container.getAttribute(\"name\");\n                return sectionName === category.section;\n            });\n            if (sectionContainer) {\n                const categoryBlock = document.createElement(\"div\");\n                categoryBlock.classList.add(\"category-block\");\n                const categoryNameElement = document.createElement(\"div\");\n                categoryNameElement.classList.add(\"category-name\");\n                categoryNameElement.textContent = category.name;\n                categoryBlock.appendChild(categoryNameElement);\n                if (category.name !== \"Running now\") {\n                    const categoryDescriptionElement = document.createElement(\"div\");\n                    categoryDescriptionElement.classList.add(\"category-description\");\n                    categoryDescriptionElement.textContent = category.description;\n                    categoryBlock.appendChild(categoryDescriptionElement);\n                }\n                if (category.name == \"Running now\") {\n                    const categoryDescriptionElement = document.createElement(\"div\");\n                    categoryDescriptionElement.classList.add(\"category-description\");\n                    categoryBlock.appendChild(categoryDescriptionElement);\n                }\n                const categoryTitlesElement = document.createElement(\"div\");\n                categoryTitlesElement.classList.add(\"category-titles\");\n                categoryTitlesElement.setAttribute(\"name\", category.name);\n                categoryBlock.appendChild(categoryTitlesElement);\n                sectionContainer.appendChild(categoryBlock);\n            }\n        });\n        queryCategories.forEach(async (category) => {\n            const queryName = category.name\n                .toLowerCase()\n                .replace(/-/g, '')\n                .replace(/['’]s?/g, '')\n                .replace(/\\s/g, '_');\n            const query = `query_${queryName}`;\n            await fetchContentForCategory(eval(query), category.name);\n        });\n    }\n    // Projects & Characters\n    async function fetchContentForCategory(queryContent, categoryName) {\n        const categoryTitlesElements = document.querySelectorAll('.category-titles');\n        categoryTitlesElements.forEach((categoryTitlesElement) => {\n            if (categoryTitlesElement.getAttribute('name') === categoryName) {\n                queryContent.forEach((content) => {\n                    if (categoryName === 'Characters') {\n                        const characterElement = document.createElement('div');\n                        characterElement.setAttribute(\"name\", content.alias);\n                        characterElement.classList.add('character');\n                        const imageElement = document.createElement('div');\n                        imageElement.classList.add('character-image');\n                        const characterImg = document.createElement('img');\n                        characterImg.src = \".\" + content.image;\n                        imageElement.appendChild(characterImg);\n                        const aliasElement = document.createElement('div');\n                        aliasElement.classList.add('character-alias');\n                        aliasElement.textContent = content.alias;\n                        const nameElement = document.createElement('div');\n                        nameElement.classList.add('character-name');\n                        nameElement.textContent = content.name;\n                        const universeElement = document.createElement('div');\n                        universeElement.classList.add('character-universe');\n                        universeElement.textContent = content.universe;\n                        characterElement.appendChild(imageElement);\n                        characterElement.appendChild(aliasElement);\n                        characterElement.appendChild(nameElement);\n                        characterElement.appendChild(universeElement);\n                        categoryTitlesElement.appendChild(characterElement);\n                    }\n                    else {\n                        const contentElement = document.createElement('div');\n                        contentElement.setAttribute(\"name\", content.title);\n                        contentElement.setAttribute(\"data-type\", content.type);\n                        contentElement.classList.add('project');\n                        const posterElement = document.createElement('div');\n                        posterElement.classList.add('project-poster');\n                        const posterImg = document.createElement('img');\n                        posterImg.src = \".\" + content.poster;\n                        posterElement.appendChild(posterImg);\n                        const titleElement = document.createElement('div');\n                        titleElement.classList.add('project-name');\n                        titleElement.textContent = content.title;\n                        const typeElement = document.createElement('div');\n                        typeElement.classList.add('project-type');\n                        typeElement.textContent = content.type;\n                        const sagaElement = document.createElement('div');\n                        sagaElement.classList.add('project-saga');\n                        sagaElement.textContent = content.saga;\n                        const phaseElement = document.createElement('div');\n                        phaseElement.classList.add('project-phase');\n                        phaseElement.textContent = content.phase;\n                        const releasedateElement = document.createElement('div');\n                        releasedateElement.classList.add('project-date');\n                        releasedateElement.textContent = content.release_date;\n                        contentElement.appendChild(posterElement);\n                        contentElement.appendChild(titleElement);\n                        contentElement.appendChild(typeElement);\n                        contentElement.appendChild(sagaElement);\n                        contentElement.appendChild(phaseElement);\n                        contentElement.appendChild(releasedateElement);\n                        if (categoryName === 'Running now') {\n                            const categoryDescriptionElement = categoryTitlesElement.previousElementSibling;\n                            if (categoryDescriptionElement) {\n                                categoryDescriptionElement.textContent = content.description;\n                            }\n                        }\n                        categoryTitlesElement.appendChild(contentElement);\n                    }\n                });\n            }\n        });\n    }\n    async function fetchWidgets() {\n        const queryWidgets = await worker.db.query(`SELECT name, sorting FROM web_widgets`);\n        const widgetColors = {\n            Next: 'widget-next',\n            Random: 'widget-random',\n            Trivia: 'widget-trivia',\n            Quiz: 'widget-quiz',\n            Rewatch: 'widget-rewatch',\n            Music: 'widget-music'\n        };\n        queryWidgets.forEach(async (widget) => {\n            const section = document.querySelector(`[name=\"${widget.sorting}\"]`);\n            if (section) {\n                const widgetElement = document.createElement('div');\n                widgetElement.classList.add('widget');\n                const backgroundColorId = widgetColors[widget.name]; // Type assertion here\n                if (backgroundColorId) {\n                    widgetElement.id = backgroundColorId;\n                    widgetElement.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue(`--${backgroundColorId}`);\n                }\n                // Widget Header\n                const widgetHeaderElement = document.createElement('div');\n                widgetHeaderElement.classList.add('widget-header');\n                // Widget Name\n                const widgetNameElement = document.createElement('div');\n                widgetNameElement.classList.add('widget-name');\n                widgetNameElement.textContent = widget.name;\n                widgetHeaderElement.appendChild(widgetNameElement);\n                // Widget Menu\n                const widgetMenuElement = document.createElement('div');\n                widgetMenuElement.classList.add('widget-menu');\n                widgetMenuElement.setAttribute('id', `${widget.name}-btn`);\n                widgetMenuElement.innerHTML = '<span class=\"material-symbols-outlined\">help</span>';\n                widgetHeaderElement.appendChild(widgetMenuElement);\n                widgetElement.appendChild(widgetHeaderElement);\n                // Widget Content\n                const widgetContentElement = document.createElement('div');\n                widgetContentElement.classList.add('widget-content');\n                // Widget Content Header\n                const widgetTextHeaderElement = document.createElement('div');\n                widgetTextHeaderElement.classList.add('widget-text-h');\n                widgetContentElement.appendChild(widgetTextHeaderElement);\n                // Widget Content Content\n                const widgetTextContentElement = document.createElement('div');\n                widgetTextContentElement.classList.add('widget-text-c');\n                widgetContentElement.appendChild(widgetTextContentElement);\n                // Widget Content Description\n                const widgetTextDescriptionElement = document.createElement('div');\n                widgetTextDescriptionElement.classList.add('widget-text-d');\n                widgetContentElement.appendChild(widgetTextDescriptionElement);\n                widgetElement.appendChild(widgetContentElement);\n                // Widget Content\n                const widgetInfoElement = document.createElement('div');\n                widgetInfoElement.classList.add('widget-info');\n                widgetElement.appendChild(widgetInfoElement);\n                // --------\n                if (widget.name === 'Next') {\n                    const daysUntilNextRelease = await calculateDaysUntilNextRelease(query_upcoming);\n                    widgetTextHeaderElement.textContent = `The Marvels`;\n                    widgetTextContentElement.textContent = `${daysUntilNextRelease} days`;\n                    widgetTextDescriptionElement.textContent = `until new release`;\n                    const result = await generateICSFile();\n                    if (result !== null) {\n                        const { blobUrl, title } = result;\n                        const widgetButtonElement = document.createElement('div');\n                        widgetButtonElement.classList.add('widget-button');\n                        widgetButtonElement.setAttribute('id', 'notify-btn');\n                        widgetButtonElement.setAttribute('data-url', blobUrl); // ics blob url\n                        widgetButtonElement.setAttribute('data-title', title); // project title\n                        widgetButtonElement.textContent = 'Notify me';\n                        widgetElement.appendChild(widgetButtonElement);\n                    }\n                    widgetInfoElement.innerHTML = `\n                  Next widget show days until nearest upcoming project. You can press Notify me button to create event for your\n                  stock Calendar app. Don't forget to set Alert to don't miss the premiere! In event you can get more info about upcoming\n                  project by open link inside. IMDb Showtimes link will show theatre near your location with premieres in it, so\n                  you can simply check where to watch project in day of premiere.\n                  Notice, that dates in USA/New York timezone.\n                  `;\n                }\n                if (widget.name === 'Random') {\n                    widgetTextContentElement.textContent = `Get random title from entire multiverse!`;\n                    const widgetButtonElement = document.createElement('div');\n                    widgetButtonElement.classList.add('widget-button');\n                    widgetButtonElement.setAttribute('id', 'random-btn');\n                    widgetButtonElement.textContent = 'Random!';\n                    widgetElement.appendChild(widgetButtonElement);\n                    widgetInfoElement.innerHTML = `\n                  Random widget give you random title from entire multiverse. You can also set from which type of categories\n                  doing random.\n\n                  <div> <input type=\"checkbox\"><span>Setting 1</span></div>\n                  `;\n                }\n                if (widget.name === 'Trivia') {\n                    widgetTextHeaderElement.textContent = `Did you know?`;\n                    widgetTextContentElement.textContent = ``;\n                    widgetTextDescriptionElement.textContent = ``;\n                    const widgetButtonElement = document.createElement('div');\n                    widgetButtonElement.classList.add('widget-button');\n                    widgetButtonElement.setAttribute('id', 'trivia-btn');\n                    widgetButtonElement.textContent = 'Another one!';\n                    widgetElement.appendChild(widgetButtonElement);\n                    widgetInfoElement.innerHTML = `\n                  Trivia widget show you random interesting fact or easter egg from entire multiverse. You can use Another one!\n                  button to show new fact. Spoilered items is blurred by default.\n\n                  <div> <input type=\"checkbox\"><span>Blur potentional spoilers</span></div>\n                  `;\n                }\n                if (widget.name === 'Quiz') {\n                    widgetTextContentElement.textContent = `Quiz`;\n                    widgetInfoElement.innerHTML = `\n                  Quiz widget show you random question about Marvel Universe knowledge. You can use Another one! button to show new\n                  question. Spoilered questions is disabled by default\n\n                  <div> <input type=\"checkbox\"><span>Disable spoiler questions</span></div>\n                  `;\n                }\n                if (widget.name === 'Rewatch') {\n                    const totalRewatchTime = await calculateTotalRewatchTime(query_runtime);\n                    let rewatchTime = '';\n                    if (totalRewatchTime.days > 0) {\n                        rewatchTime += `${totalRewatchTime.days} days `;\n                    }\n                    if (totalRewatchTime.hours > 0) {\n                        rewatchTime += `${totalRewatchTime.hours} hours `;\n                    }\n                    rewatchTime += `${totalRewatchTime.minutes} minutes`;\n                    widgetTextHeaderElement.textContent = `You need`;\n                    widgetTextContentElement.textContent = `${rewatchTime}`;\n                    widgetTextDescriptionElement.textContent = `to rewatch all content`;\n                    const widgetButtonElement = document.createElement('div');\n                    widgetButtonElement.classList.add('widget-button');\n                    widgetButtonElement.setAttribute('id', 'rewatch-checklist-btn');\n                    widgetButtonElement.textContent = 'Rewatch Checklist';\n                    widgetElement.appendChild(widgetButtonElement);\n                    widgetInfoElement.innerHTML = `\n                  Rewatch widget show how many time need to spend to rewatch entire multiverse content. You can also check istamate\n                  time for different categories and types of projects.\n\n                  Rewatch Checklist button opens Rewatch Checklist, where you can combine and print checklist to rewatch universe projects.\n                  `;\n                }\n                if (widget.name === 'Music') {\n                    const widgetButtonElement = document.createElement('div');\n                    widgetButtonElement.classList.add('widget-button');\n                    widgetButtonElement.setAttribute('id', 'music-btn');\n                    widgetButtonElement.textContent = 'Listen';\n                    widgetElement.appendChild(widgetButtonElement);\n                    widgetInfoElement.innerHTML = `\n                  Music widget show random song from Marvel Music. It can be project soundtrack or music used in it. You can listen preview\n                  of song not leaving page. For listen full track use Open Playlist button to listen Marvel Music on streaming platforms.\n                  `;\n                }\n                section.appendChild(widgetElement);\n            }\n        });\n    }\n    // Widget: Next onload info\n    async function calculateDaysUntilNextRelease(query_upcoming) {\n        if (query_upcoming && query_upcoming.length > 0) {\n            const nextReleaseDate = new Date(query_upcoming[0].release_date);\n            const today = new Date();\n            const timeDiff = nextReleaseDate.getTime() - today.getTime();\n            const daysUntilNextRelease = Math.ceil(timeDiff / (1000 * 3600 * 24));\n            return daysUntilNextRelease;\n        }\n        return 0;\n    }\n    // Widget: Next event generation\n    async function generateICSFile() {\n        const nextWidget = query_upcoming[0];\n        if (!nextWidget) {\n            return null;\n        }\n        const { title, description, release_date, imdb } = nextWidget;\n        const startDate = new Date(release_date);\n        const icsContent = `BEGIN:VCALENDAR\nVERSION:2.0\nBEGIN:VEVENT\nSUMMARY:${title}\nDTSTART;VALUE=DATE:${startDate.toISOString().slice(0, 10).replace(/[-:]/g, '')}\nDESCRIPTION:${description}\nLOCATION:https://www.imdb.com/showtimes/\nSTATUS:CONFIRMED\nSEQUENCE:0\nURL:${imdb}\nEND:VEVENT\nEND:VCALENDAR`;\n        const blob = new Blob([icsContent], { type: 'text/calendar' });\n        const blobUrl = URL.createObjectURL(blob);\n        return { blobUrl, title };\n    }\n    // Widget: Rewatch onload info\n    async function calculateTotalRewatchTime(query_runtime) {\n        if (query_runtime && query_runtime.length > 0) {\n            const totalRuntimeMinutes = query_runtime.reduce((total, entry) => total + entry.runtime, 0);\n            const totalDays = Math.floor(totalRuntimeMinutes / (60 * 24));\n            const remainingMinutes = totalRuntimeMinutes % (60 * 24);\n            const totalHours = Math.floor(remainingMinutes / 60);\n            const totalMinutes = remainingMinutes % 60;\n            return { days: totalDays, hours: totalHours, minutes: totalMinutes };\n        }\n        return { days: 0, hours: 0, minutes: 0 };\n    }\n    await fetchSections();\n    await fetchCategories();\n    await fetchWidgets();\n    return Promise.resolve();\n}\nload().then(() => {\n    // Preloader\n    const preloader = document.querySelector('.preloader');\n    if (preloader) {\n        preloader.style.display = 'none';\n    }\n    // Window: Get data\n    async function getProjectData(target) {\n        const projectDiv = target.closest('.project');\n        if (!projectDiv) {\n            return null;\n        }\n        const name = projectDiv.getAttribute('name');\n        const type = projectDiv.getAttribute('data-type');\n        if (!name || !type) {\n            return null;\n        }\n        const tableNames = ['titles_animation', 'titles_books', 'titles_comics', 'titles_documentary',\n            'titles_games', 'titles_movies', 'titles_movies_legacy', 'titles_musicals', 'titles_oneshots',\n            'titles_specials', 'titles_tv', 'titles_webseries'];\n        const results = [];\n        const episodesTables = ['episodes_animation', 'episodes_tv', 'episodes_webseries'];\n        const episodesResults = [];\n        for (const tableName of tableNames) {\n            const query = `SELECT * FROM ${tableName} WHERE title = ? AND type = ?`;\n            const queryResult = await worker.db.query(query, [name, type]);\n            if (queryResult.length > 0) {\n                results.push({ tableName, rows: queryResult });\n            }\n        }\n        for (const episodesTable of episodesTables) {\n            const query = `SELECT * FROM ${episodesTable} WHERE tv_title = ?`;\n            const queryResult = await worker.db.query(query, [name]);\n            if (queryResult.length > 0) {\n                episodesResults.push({ episodesTable, rows: queryResult });\n            }\n        }\n        const posterUrl = projectDiv.querySelector('.project-poster img')?.getAttribute('src');\n        // const description = projectDiv.querySelector('.project-description') ?.textContent;\n        const project_data = results.find(result => result.tableName.includes('titles'))?.rows[0] || {};\n        // const details_data = results.find(result => result.tableName.includes('titles'))?.rows[0] || {};\n        // const link_data = results.find(result => result.tableName.includes('titles'))?.rows[0] || {};\n        const episodes_data = episodesResults.flatMap(result => result.rows);\n        return {\n            name,\n            type,\n            posterUrl,\n            project_data,\n            episodes_data\n        };\n    }\n    // Window: Template\n    function createProjectPageWindow(projectData) {\n        const episodeSection = (projectData.type === 'TV Show' || projectData.type === 'Web series') && projectData.episodes_data.length > 0\n            ? `\n                <div class=\"project-page-episodes\">\n                <div class=\"project-page-header\">Episodes</div>\n                    ${createSeasonSections(projectData.episodes_data)}\n                </div>`\n            : '';\n        function createSeasonSections(episodes) {\n            const seasonsMap = new Map();\n            for (const episode of episodes) {\n                if (!seasonsMap.has(episode.season)) {\n                    seasonsMap.set(episode.season, []);\n                }\n                seasonsMap.get(episode.season).push(episode);\n            }\n            return [...seasonsMap.entries()].map(([season, seasonEpisodes]) => `\n            <div class=\"project-page-season-header\">Season ${season} <span class=\"season-grid-view\">Grid view</span></div>\n                <div class=\"project-page-seasons-section\">\n                    ${seasonEpisodes.map((episode) => `\n                        <div class=\"project-page-episode\">\n                            <div class=\"project-season-cover\"><img src=\".${episode.poster}\"></div>\n                            <div class=\"project-epsiode-details\">\n                                <div class=\"project-episode-name\">${episode.episode_title}</div>\n                                <div class=\"project-episode-description\">${episode.description}</div>\n                                <div class=\"project-episode-release-date\">Episode ${episode.episode_id} • ${episode.release_date}</div>\n                            </div>\n                        </div>\n                    `).join('')}\n                </div>\n            `).join('');\n        }\n        return `\n          <div class=\"project-page-close\">\n              <div class=\"project-page-close-button\"></div>\n              <div class=\"project-page-close-button-x\"><span class=\"material-symbols-outlined\">close</span></div>\n          </div>\n  \n          <div class=\"project-page-header-little\">\n            <div class=\"project-page-header-content\">\n              <div class=\"project-page-header-little-title\">${projectData.name}</div>\n              <div class=\"project-page-header-little-type\">${projectData.type}</div>\n            </div>\n          </div>\n  \n          <div class=\"project-page-cover\" style=\"background-image: url('${projectData.posterUrl}');\"></div>\n  \n          <div class=\"project-page-content\">\n  \n              <div class=\"project-page-card-block\">\n                  <div class=\"project-page-card\">\n                      <div class=\"project-poster\"><img src=\"${projectData.posterUrl}\"></div>\n                      <div class=\"project-page-name\">${projectData.name}</div>\n                      <div class=\"project-page-type\">${projectData.type}</div>\n                  </div>\n              </div>\n  \n              <div class=\"project-page-description\">\n                  ${projectData.project_data.description}\n              </div>\n  \n          </div>\n  \n          <div class=\"project-page-universe\">\n              <div class=\"project-page-section-content\">\n                  ${projectData.project_data.phase ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Phase</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.phase}</div>\n                  </div>` : ''}\n                  ${projectData.project_data.saga ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Saga</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.saga}</div>\n                  </div>` : ''}\n                  ${projectData.project_data.storyorder ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Story order</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.storyorder}</div>\n                  </div>` : ''}\n                  ${projectData.project_data.universe ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Universe</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.universe}</div>\n                  </div>` : ''}\n                  ${projectData.project_data.story_date ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Story date</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.story_date}</div>\n                  </div>` : ''}\n                  ${projectData.project_data.series ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Series</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.series}</div>\n                  </div>` : ''}\n              </div>\n          </div>\n  \n          ${episodeSection}\n  \n          <div class=\"project-page-details\">\n              <div class=\"project-page-section-content\">\n                  ${projectData.project_data.release_date ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Release date</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.release_date}</div>\n                  </div>` : ''}\n                  ${projectData.project_data.studio ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Studio</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.studio}</div>\n                  </div>` : ''}\n                  ${projectData.project_data.director ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Director</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.director}</div>\n                  </div>` : ''}\n              </div>\n          </div>\n\n          <div class=\"project-page-details\">\n              <div class=\"project-page-section-content\">\n                  ${projectData.project_data.runtime ? `<div class=\"project-page-info-block\">\n                      <div class=\"project-page-info-block-name\">Runtime</div>\n                      <div class=\"project-page-info-block-content\">${projectData.project_data.runtime} minutes</div>\n                  </div>` : ''}\n              </div>\n          </div>\n  \n          <div class=\"project-page-links\">\n              <div class=\"project-page-link\">\n                  <a href=\"${projectData.project_data.imdb}\" target=\"_blank\">Learn more <span class=\"material-symbols-outlined\">chevron_right</span></a>\n              </div>\n          </div>\n      `;\n    }\n    let startY;\n    let lastY;\n    let scrollingDown = false;\n    let isAtDefaultScroll = true; // Flag to track if scroll is at default position\n    let gestureOccurred = false; // Flag to track if gesture occurred once\n    let shouldTrackGestures = false; // Flag to determine whether to track gestures\n    // Store the default scroll position when the window is opened\n    let defaultScrollY;\n    // Reference to the project page element\n    let projectPage = null;\n    // Window: Open function\n    async function openProjectWindow(event) {\n        const projectBackground = document.querySelector('.project-page-background');\n        const existingProjectPage = projectBackground.querySelector('.project-page');\n        const projectData = await getProjectData(event.target);\n        if (!projectData) {\n            return;\n        }\n        document.addEventListener('keydown', escKeyListener); // Add the event listener\n        defaultScrollY = projectPage?.scrollTop || 0;\n        if (!existingProjectPage) {\n            const projectPage = document.createElement('div');\n            projectPage.classList.add('project-page');\n            projectPage.setAttribute('name', projectData.name);\n            const projectPageWindow = createProjectPageWindow(projectData);\n            projectPage.innerHTML = projectPageWindow;\n            projectBackground.appendChild(projectPage);\n            projectPage.classList.add('project-page-animation');\n            const closeButton = projectPage.querySelector('.project-page-close-button');\n            if (closeButton) {\n                closeButton.addEventListener('click', () => closeProjectWindow(projectBackground));\n            }\n            const closeButtonX = document.querySelector('.project-page-close-button-x');\n            if (closeButtonX) {\n                closeButtonX.addEventListener('click', () => closeProjectWindow(projectBackground));\n            }\n        }\n        else {\n            const projectPageWindow = createProjectPageWindow(projectData);\n            existingProjectPage.setAttribute('name', projectData.name);\n            existingProjectPage.innerHTML = '';\n            existingProjectPage.innerHTML = projectPageWindow;\n            existingProjectPage.classList.add('project-page-animation'); // Add animation class\n            projectBackground.appendChild(existingProjectPage);\n            const closeButton = existingProjectPage.querySelector('.project-page-close-button');\n            if (closeButton) {\n                closeButton.addEventListener('click', () => closeProjectWindow(projectBackground));\n            }\n            const closeButtonX = document.querySelector('.project-page-close-button-x');\n            if (closeButtonX) {\n                closeButtonX.addEventListener('click', () => closeProjectWindow(projectBackground));\n            }\n        }\n        projectBackground.style.display = 'block';\n        document.body.style.overflow = 'hidden';\n        shouldTrackGestures = true;\n    }\n    // Window: Close\n    function closeProjectWindow(projectBackground) {\n        gestureOccurred = false; // Reset the gestureOccurred flag\n        shouldTrackGestures = false; // Reset the shouldTrackGestures flag\n        projectBackground.style.display = 'none';\n        document.body.style.overflow = 'auto';\n        document.removeEventListener('keydown', escKeyListener); // Remove the event listener\n    }\n    // Function to handle Esc key press\n    function escKeyListener(event) {\n        if (event.key === 'Escape') {\n            const projectBackground = document.querySelector('.project-page-background');\n            closeProjectWindow(projectBackground);\n        }\n    }\n    // Handle touchstart event to store the starting Y coordinate\n    document.addEventListener('touchstart', (event) => {\n        startY = event.touches[0].clientY;\n        lastY = startY;\n        scrollingDown = false;\n    });\n    // Handle touchmove event to determine scrolling direction\n    document.addEventListener('touchmove', (event) => {\n        if (!shouldTrackGestures)\n            return; // Exit if not tracking gestures\n        const currentY = event.touches[0].clientY;\n        scrollingDown = currentY > lastY;\n        lastY = currentY;\n    });\n    // Handle touchend event to check if swipe-down gesture occurred\n    document.addEventListener('touchend', () => {\n        if (isAtDefaultScroll && scrollingDown && shouldTrackGestures) {\n            gestureOccurred = true;\n            const projectBackground = document.querySelector('.project-page-background');\n            closeProjectWindow(projectBackground);\n        }\n    });\n    // Get default scroll position in window\n    // Handle window scroll event to track if scroll is at default position\n    window.addEventListener('scroll', () => {\n        if (projectPage) {\n            isAtDefaultScroll = projectPage.scrollTop === defaultScrollY;\n        }\n    });\n    // Window: Open listener\n    const projectDivs = document.querySelectorAll('.project');\n    projectDivs.forEach((projectDiv) => {\n        projectDiv.addEventListener('click', (event) => {\n            openProjectWindow(event);\n            projectPage = projectDiv.querySelector('.project-page');\n            gestureOccurred = false; // Reset the gestureOccurred flag\n        });\n    });\n    // Widget: Next\n    const notifyButton = document.getElementById('notify-btn');\n    if (notifyButton) {\n        notifyButton.addEventListener('click', () => {\n            const icsBlobUrl = notifyButton.getAttribute('data-url');\n            const projectTitle = notifyButton.getAttribute('data-title');\n            if (icsBlobUrl) {\n                const a = document.createElement('a');\n                a.href = icsBlobUrl;\n                a.download = projectTitle + '.ics';\n                a.click();\n            }\n        });\n    }\n    // Widget: Trivia\n    const triviaButton = document.getElementById('trivia-btn');\n    if (triviaButton) {\n        triviaButton.addEventListener('click', async () => {\n            const query_trivia = await worker.db.query(`SELECT * FROM universe_trivia`);\n            if (query_trivia.length === 0) {\n                console.log(\"No trivia found\");\n                return;\n            }\n            const randomIndex = Math.floor(Math.random() * query_trivia.length);\n            const randomTrivia = query_trivia[randomIndex];\n            const { trivia, project } = randomTrivia;\n            const widgetTriviaElement = document.getElementById('widget-trivia');\n            if (widgetTriviaElement) {\n                const widgetTextContentElement = widgetTriviaElement.querySelector('.widget-text-c');\n                if (widgetTextContentElement) {\n                    widgetTextContentElement.textContent = trivia;\n                }\n                const widgetTextDescriptionElement = widgetTriviaElement.querySelector('.widget-text-d');\n                if (widgetTextDescriptionElement) {\n                    widgetTextDescriptionElement.textContent = project;\n                }\n            }\n        });\n    }\n    // Widget: Random\n    const randomButton = document.getElementById('random-btn');\n    if (randomButton) {\n        randomButton.addEventListener('click', async () => {\n            const query_random = await worker.db.query(`SELECT * FROM titles_movies`);\n            if (query_random.length === 0) {\n                console.log(\"No titles found\");\n                return;\n            }\n            const randomIndex = Math.floor(Math.random() * query_random.length);\n            const randomTitle = query_random[randomIndex];\n            const { title, type } = randomTitle;\n            const widgetTriviaElement = document.getElementById('widget-random');\n            if (widgetTriviaElement) {\n                const widgetTextHeaderElement = widgetTriviaElement.querySelector('.widget-text-h');\n                if (widgetTextHeaderElement) {\n                    widgetTextHeaderElement.textContent = type;\n                }\n                const widgetTextContentElement = widgetTriviaElement.querySelector('.widget-text-c');\n                if (widgetTextContentElement) {\n                    widgetTextContentElement.textContent = title;\n                }\n                // Load ${project} in div inside widget div with  `widget-text-d` class\n                // const widgetTextDescriptionElement = widgetTriviaElement.querySelector('.widget-text-d');\n                // if (widgetTextDescriptionElement) {\n                //     widgetTextDescriptionElement.textContent = project;\n                // }\n            }\n        });\n    }\n    // Menu: Notifications\n    const notificationsButton = document.getElementById('notifications-btn');\n    const notificationsMenu = document.getElementById('menu-notifications');\n    if (notificationsButton && notificationsMenu) {\n        let menuOpen = false;\n        const openMenu = () => {\n            notificationsMenu.style.display = 'block';\n            menuOpen = true;\n        };\n        const closeMenu = () => {\n            notificationsMenu.style.display = 'none';\n            menuOpen = false;\n        };\n        notificationsButton.addEventListener('click', () => {\n            if (menuOpen) {\n                closeMenu();\n            }\n            else {\n                openMenu();\n            }\n        });\n        document.addEventListener('click', (event) => {\n            const target = event.target;\n            if (!notificationsMenu.contains(target) && !notificationsButton.contains(target)) {\n                closeMenu();\n            }\n        });\n        document.addEventListener('keydown', (event) => {\n            if (event.key === 'Escape') {\n                closeMenu();\n            }\n        });\n    }\n    // Button: Subscribe\n    const subscribeButton = document.getElementById('subscribe-btn');\n    if (subscribeButton) {\n        subscribeButton.addEventListener('click', () => {\n            const telegramLink = 'https://t.me/mcurandom';\n            window.open(telegramLink);\n        });\n    }\n    // Menu: Settings\n    const settingsButton = document.getElementById('settings-btn');\n    const settingsMenu = document.getElementById('menu-settings');\n    if (settingsButton && settingsMenu) {\n        let menuOpen = false;\n        const openMenu = () => {\n            settingsMenu.style.display = 'block';\n            menuOpen = true;\n        };\n        const closeMenu = () => {\n            settingsMenu.style.display = 'none';\n            menuOpen = false;\n        };\n        settingsButton.addEventListener('click', () => {\n            if (menuOpen) {\n                closeMenu();\n            }\n            else {\n                openMenu();\n            }\n        });\n        document.addEventListener('click', (event) => {\n            const target = event.target;\n            if (!settingsMenu.contains(target) && !settingsButton.contains(target)) {\n                closeMenu();\n            }\n        });\n        document.addEventListener('keydown', (event) => {\n            if (event.key === 'Escape') {\n                closeMenu();\n            }\n        });\n    }\n    // Menu: Settings in Next widget\n    const widgetSettingsNextButton = document.getElementById('Next-btn');\n    const widgetSettingsNextMenu = document.getElementById('next-menu-settings');\n    if (widgetSettingsNextButton && widgetSettingsNextMenu) {\n        let menuOpen = false;\n        const openMenu = () => {\n            widgetSettingsNextMenu.style.display = 'block';\n            menuOpen = true;\n        };\n        const closeMenu = () => {\n            widgetSettingsNextMenu.style.display = 'none';\n            menuOpen = false;\n        };\n        widgetSettingsNextButton.addEventListener('click', () => {\n            if (menuOpen) {\n                closeMenu();\n            }\n            else {\n                openMenu();\n            }\n        });\n        document.addEventListener('click', (event) => {\n            const target = event.target;\n            if (!widgetSettingsNextMenu.contains(target) && !widgetSettingsNextButton.contains(target)) {\n                closeMenu();\n            }\n        });\n        document.addEventListener('keydown', (event) => {\n            if (event.key === 'Escape') {\n                closeMenu();\n            }\n        });\n    }\n});\n\n\n//# sourceURL=webpack:///./src/index.ts?");

/***/ }),

/***/ "./node_modules/sql.js-httpvfs/dist/sql-wasm.wasm":
/*!********************************************************!*\
  !*** ./node_modules/sql.js-httpvfs/dist/sql-wasm.wasm ***!
  \********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("module.exports = __webpack_require__.p + \"8a2a3c8efae774018112.wasm\";\n\n//# sourceURL=webpack:///./node_modules/sql.js-httpvfs/dist/sql-wasm.wasm?");

/***/ }),

/***/ "./node_modules/sql.js-httpvfs/dist/sqlite.worker.js":
/*!***********************************************************!*\
  !*** ./node_modules/sql.js-httpvfs/dist/sqlite.worker.js ***!
  \***********************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

"use strict";
eval("module.exports = __webpack_require__.p + \"9181ee78cd72b9be8ba3.js\";\n\n//# sourceURL=webpack:///./node_modules/sql.js-httpvfs/dist/sqlite.worker.js?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = __webpack_modules__;
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/publicPath */
/******/ 	(() => {
/******/ 		var scriptUrl;
/******/ 		if (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + "";
/******/ 		var document = __webpack_require__.g.document;
/******/ 		if (!scriptUrl && document) {
/******/ 			if (document.currentScript)
/******/ 				scriptUrl = document.currentScript.src;
/******/ 			if (!scriptUrl) {
/******/ 				var scripts = document.getElementsByTagName("script");
/******/ 				if(scripts.length) {
/******/ 					var i = scripts.length - 1;
/******/ 					while (i > -1 && !scriptUrl) scriptUrl = scripts[i--].src;
/******/ 				}
/******/ 			}
/******/ 		}
/******/ 		// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration
/******/ 		// or pass an empty string ("") and set the __webpack_public_path__ variable from your code to use your own logic.
/******/ 		if (!scriptUrl) throw new Error("Automatic publicPath is not supported in this browser");
/******/ 		scriptUrl = scriptUrl.replace(/#.*$/, "").replace(/\?.*$/, "").replace(/\/[^\/]+$/, "/");
/******/ 		__webpack_require__.p = scriptUrl;
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/jsonp chunk loading */
/******/ 	(() => {
/******/ 		__webpack_require__.b = document.baseURI || self.location.href;
/******/ 		
/******/ 		// object to store loaded and loading chunks
/******/ 		// undefined = chunk not loaded, null = chunk preloaded/prefetched
/******/ 		// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded
/******/ 		var installedChunks = {
/******/ 			"main": 0
/******/ 		};
/******/ 		
/******/ 		// no chunk on demand loading
/******/ 		
/******/ 		// no prefetching
/******/ 		
/******/ 		// no preloaded
/******/ 		
/******/ 		// no HMR
/******/ 		
/******/ 		// no HMR manifest
/******/ 		
/******/ 		// no on chunks loaded
/******/ 		
/******/ 		// no jsonp function
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/index.ts");
/******/ 	
/******/ })()
;